2025-08-22 15:19:59.997 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-22 15:26:22.718 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-22 15:26:23.326 +01:00 [DBG] Entity Framework Core 9.0.8 initialized 'CMSDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.7' with options: EngineType=SqlServer 
2025-08-22 15:26:24.236 +01:00 [DBG] 'CMSDbContext' disposed.
2025-08-22 15:28:19.763 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-08-22 15:28:20.392 +01:00 [DBG] Entity Framework Core 9.0.8 initialized 'CMSDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.7' with options: EngineType=SqlServer 
2025-08-22 15:28:20.617 +01:00 [DBG] Creating DbConnection.
2025-08-22 15:28:20.707 +01:00 [DBG] Created DbConnection. (103ms).
2025-08-22 15:28:20.713 +01:00 [DBG] Migrating using database 'CMSDb' on server 'localhost\SQLEXPRESS'.
2025-08-22 15:28:20.724 +01:00 [DBG] Opening connection to database 'CMSDb' on server 'localhost\SQLEXPRESS'.
2025-08-22 15:28:21.170 +01:00 [DBG] Opened connection to database 'CMSDb' on server 'localhost\SQLEXPRESS'.
2025-08-22 15:28:21.180 +01:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-22 15:28:21.193 +01:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (11ms).
2025-08-22 15:28:21.196 +01:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (20ms).
2025-08-22 15:28:21.209 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-22 15:28:21.268 +01:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-22 15:28:21.270 +01:00 [DBG] Closing connection to database 'CMSDb' on server 'localhost\SQLEXPRESS'.
2025-08-22 15:28:21.290 +01:00 [DBG] Closed connection to database 'CMSDb' on server 'localhost\SQLEXPRESS' (6ms).
2025-08-22 15:28:21.292 +01:00 [DBG] Opening connection to database 'CMSDb' on server 'localhost\SQLEXPRESS'.
2025-08-22 15:28:21.293 +01:00 [DBG] Opened connection to database 'CMSDb' on server 'localhost\SQLEXPRESS'.
2025-08-22 15:28:21.295 +01:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-22 15:28:21.299 +01:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-22 15:28:21.299 +01:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-22 15:28:21.299 +01:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-08-22 15:28:21.300 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-22 15:28:21.339 +01:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-08-22 15:28:21.465 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-22 15:28:21.475 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-08-22 15:28:21.478 +01:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-22 15:28:21.478 +01:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.480 +01:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2ms).
2025-08-22 15:28:21.480 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-22 15:28:21.486 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-08-22 15:28:21.489 +01:00 [DBG] Committing transaction.
2025-08-22 15:28:21.495 +01:00 [DBG] Committed transaction.
2025-08-22 15:28:21.497 +01:00 [DBG] Disposing transaction.
2025-08-22 15:28:21.501 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-08-22 15:28:21.502 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-08-22 15:28:21.503 +01:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-22 15:28:21.504 +01:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.504 +01:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.504 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-22 15:28:21.504 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-22 15:28:21.505 +01:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-22 15:28:21.505 +01:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-22 15:28:21.505 +01:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-08-22 15:28:21.505 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-22 15:28:21.507 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-08-22 15:28:21.509 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-08-22 15:28:21.510 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-08-22 15:28:21.510 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-08-22 15:28:21.510 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-22 15:28:21.542 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-22 15:28:21.547 +01:00 [DBG] Closing data reader to 'CMSDb' on server 'localhost\SQLEXPRESS'.
2025-08-22 15:28:21.549 +01:00 [DBG] A data reader for 'CMSDb' on server 'localhost\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-08-22 15:28:21.559 +01:00 [INF] Applying migration '20250822142624_AddDepartmentEntity'.
2025-08-22 15:28:21.587 +01:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-22 15:28:21.587 +01:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.587 +01:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.587 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Employees] ADD [DeptId] int NOT NULL DEFAULT 0;
2025-08-22 15:28:21.618 +01:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Employees] ADD [DeptId] int NOT NULL DEFAULT 0;
2025-08-22 15:28:21.618 +01:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-22 15:28:21.618 +01:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.618 +01:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.618 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Departments] (
    [DeptId] int NOT NULL IDENTITY,
    [DeptName] nvarchar(max) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Departments] PRIMARY KEY ([DeptId])
);
2025-08-22 15:28:21.626 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Departments] (
    [DeptId] int NOT NULL IDENTITY,
    [DeptName] nvarchar(max) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Departments] PRIMARY KEY ([DeptId])
);
2025-08-22 15:28:21.626 +01:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-22 15:28:21.626 +01:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.626 +01:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.626 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Employees_DeptId] ON [Employees] ([DeptId]);
2025-08-22 15:28:21.657 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Employees_DeptId] ON [Employees] ([DeptId]);
2025-08-22 15:28:21.657 +01:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-08-22 15:28:21.658 +01:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.658 +01:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-08-22 15:28:21.658 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Employees] ADD CONSTRAINT [FK_Employees_Departments_DeptId] FOREIGN KEY ([DeptId]) REFERENCES [Departments] ([DeptId]) ON DELETE NO ACTION;
2025-08-22 15:28:21.686 +01:00 [ERR] Failed executing DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Employees] ADD CONSTRAINT [FK_Employees_Departments_DeptId] FOREIGN KEY ([DeptId]) REFERENCES [Departments] ([DeptId]) ON DELETE NO ACTION;
2025-08-22 15:28:21.686 +01:00 [DBG] Disposing transaction.
2025-08-22 15:28:21.691 +01:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-08-22 15:28:21.691 +01:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-08-22 15:28:21.691 +01:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-08-22 15:28:21.692 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-08-22 15:28:21.696 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-08-22 15:28:21.697 +01:00 [DBG] Closing connection to database 'CMSDb' on server 'localhost\SQLEXPRESS'.
2025-08-22 15:28:21.697 +01:00 [DBG] Closed connection to database 'CMSDb' on server 'localhost\SQLEXPRESS' (0ms).
2025-08-22 15:28:21.699 +01:00 [DBG] 'CMSDbContext' disposed.
2025-08-22 15:28:21.702 +01:00 [DBG] Disposing connection to database 'CMSDb' on server 'localhost\SQLEXPRESS'.
2025-08-22 15:28:21.704 +01:00 [DBG] Disposed connection to database '' on server '' (1ms).
